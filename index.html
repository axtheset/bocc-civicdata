<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="../../assets/ico/favicon.ico">

    <title>Charlotte County, FL - CivicData.io Examples</title>

    <!-- The Styles -->
    <link href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">

<!-- Bootstrap themes. Uncomment your favorite. -->
    <!--link href="//netdna.bootstrapcdn.com/bootswatch/3.1.1/cerulean/bootstrap.min.css" rel="stylesheet"-->
    <link href="http://netdna.bootstrapcdn.com/bootswatch/3.1.1/spacelab/bootstrap.min.css" rel="stylesheet">
    <!--link href="http://netdna.bootstrapcdn.com/bootswatch/3.1.1/yeti/bootstrap.min.css" rel="stylesheet"-->
 
    <link rel="stylesheet" type="text/css" href="assets/c3.css">
    <style type="text/css">
      body {
        margin-top: 40px;
      }
    </style>

  </head>

  <body role="document">

    <!-- Fixed navbar -->
    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Charlotte County, FL -  CivicData.io Data Examples</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="about.html">About</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>

    <div class="container theme-showcase" role="main">
    <a name="top"></a>     
    <!--<div class="page-header">
      <a href="#top">Permit Applications Opened By Type Year to Date</a> | <a href="#byyear">Permit Applications Opened By Year</a> | <a href="#pietype">Permits Applications Opened by Type</a> 
    </div>-->
      <a name="yeartodate"></a>       
      <div class="page-header">
        <h1>Permit Applications Opened By Type Year to Date</h1>
      </div>

      <div id="chart"></div>
      <div class="page-header">
        <h4>Query Details</h4>
      </div>
      <p><a href="http://www.civicdata.io/en/home" target="_blank">CivicData.io</a>'s SQL Search API lets you execute SQL statements against datasets</p>
      <p>The chart above was generated by querying the <a href="http://www.civicdata.com/en/dataset/generic_vrecord_3677/resource/163d8400-3ffd-4739-82c9-8c2f58ecd923" target="_blank">Building Permit dataset in CivicData.io</a>. To see the raw JSON resonse for the SQL query below, click <a href="http://www.civicdata.com/api/action/datastore_search_sql?sql=SELECT%20substring(%22DATE%20OPENED%22%20from%206%20for%202)%20as%20Month,%20substring(%22DATE%20OPENED%22%20from%201%20for%204)%20as%20Year,%20%22RECORD%20TYPE%20TYPE%22%20as%20RecordType,count(*)%20as%20Count%20from%20%22163d8400-3ffd-4739-82c9-8c2f58ecd923%22%20where%20%22DATE%20OPENED%22%20%3E=%20%272014-01-01%27%20and%20%22DATE%20OPENED%22%20%3C=%20%272014-12-31%27%20group%20by%20Month,%20Year,%20RecordType%20order%20by%20Year,%20Month,%20RecordType" target= "_blank">here</a>.</p>
      <div class="well">
        <pre>
  SELECT substring("DATE OPENED" from 1 for 4) as Year, 
    substring("DATE OPENED" from 6 for 2) as Month, 
    "RECORD TYPE TYPE" as RecordType,
    count(*) as Count 
  from "163d8400-3ffd-4739-82c9-8c2f58ecd923" 
  where "DATE OPENED" >= '2014-01-01' 
    and "DATE OPENED" <= '2014-12-31' 
  group by Year, Month, RecordType 
  order by Year, Month, RecordType
        </pre>
      <a name="byyear"></a> 
      </div>

      
      <div class="page-header">
        <h1>Permit Applications Opened By Year</h1>
      </div>

      <div id="chartYear"></div>
      <div class="page-header">
        <h4>Query Details</h4>
      </div>
      <p>The chart above was generated by querying the <a href="http://www.civicdata.com/en/dataset/generic_vrecord_3677/resource/163d8400-3ffd-4739-82c9-8c2f58ecd923" target="_blank">Building Permit dataset in CivicData.io</a>. To see the raw JSON resonse for the SQL query below, click <a href="http://www.civicdata.com/api/action/datastore_search_sql?sql=SELECT%20substring(%22DATE%20OPENED%22%20from%201%20for%204)%20as%20Year,%20substring(%22DATE%20OPENED%22%20from%206%20for%202)%20as%20Month,%20count(*)%20as%20Count%20from%20%22163d8400-3ffd-4739-82c9-8c2f58ecd923%22%20group%20by%20Year,%20Month%20order%20by%20Year,%20Month" target= "_blank">here</a>.</p>
      <div class="well">
        <pre>
  SELECT substring("DATE OPENED" from 1 for 4) as Year, 
    substring("DATE OPENED" from 6 for 2) as Month, 
    count(*) as Count 
  from "163d8400-3ffd-4739-82c9-8c2f58ecd923" 
  group by Year, Month 
  order by Year, Month
        </pre>
      </div>
      <a name="pietype"></a>
      <div class="page-header">
        <h1>Permits Applications Opened by Type</h1>
      </div>

      <div id="pieChart"></div>

      <div class="page-header">
        <h4>Query Details</h4>
      </div>
      <p>The chart above was generated by querying the <a href="http://www.civicdata.com/en/dataset/generic_vrecord_3677/resource/163d8400-3ffd-4739-82c9-8c2f58ecd923" target="_blank">Building Permit dataset in CivicData.io</a>. To see the raw JSON resonse for the SQL query below, click <a href="http://www.civicdata.com/api/action/datastore_search_sql?sql=SELECT%20%22RECORD%20TYPE%20SUBTYPE%22%20as%20RecordType,%20count(*)%20as%20Count%20from%20%22163d8400-3ffd-4739-82c9-8c2f58ecd923%22%20group%20by%20RecordType%20order%20by%20Count%20desc" target= "_blank">here</a>.</p>
      <div class="well">
        <pre>
  SELECT "RECORD TYPE SUBTYPE" as RecordType, 
    count(*) as Count 
  from "163d8400-3ffd-4739-82c9-8c2f58ecd923" 
  group by RecordType 
  order by Count desc
        </pre>
      </div>

    </div> <!-- /container -->


    <!-- Le JavaScripts-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="assets/c3.min.js"></script>
    <script type="text/javascript">
      $(document).ready(function() {
         
        var urlTimeSeries = 'http://www.civicdata.com/api/action/datastore_search_sql?sql=SELECT%20substring(%22DATE%20OPENED%22%20from%206%20for%202)%20as%20Month,%20substring(%22DATE%20OPENED%22%20from%201%20for%204)%20as%20Year,%20%22RECORD%20TYPE%20TYPE%22%20as%20RecordType,count(*)%20as%20Count%20from%20%22163d8400-3ffd-4739-82c9-8c2f58ecd923%22%20where%20%22DATE%20OPENED%22%20%3E=%20%272014-01-01%27%20and%20%22DATE%20OPENED%22%20%3C=%20%272014-12-31%27%20group%20by%20Month,%20Year,%20RecordType%20order%20by%20Year,%20Month,%20RecordType';


        
        // Helper function to make request for JSONP.
        function requestJSON(url, callback) {
          $.ajax({
            url: url,
            complete: function(xhr) {
              callback.call(null, xhr.responseJSON);
            }
          });
        }


        // Make API call and format results.
        requestJSON(urlTimeSeries, function(json) {
          var records = json.result.records
          var accessoriesCounts = ['Accessories'];
          var constructionCounts = ['Construction'];
          var tradeCounts = ['Trade Permits'];
          for(var i=0; i<records.length; i++) {
            if (records[i].recordtype == "Accessories")
              accessoriesCounts.push(parseInt(records[i].count));
            if (records[i].recordtype == "Construction")
              constructionCounts.push(parseInt(records[i].count));
            if (records[i].recordtype == "Trade Permits")
              tradeCounts.push(parseInt(records[i].count));
          }

            var chart = c3.generate({
              bindto: '#chart',
              data: {
                  x: 'x',
                  columns: [
                      ['x', '2014-01-15', '2014-02-15','2014-03-15', '2014-04-15', '2014-05-15', '2014-06-15', '2014-07-15', '2014-08-15', '2014-09-15', '2014-10-15', '2014-11-15', '2014-12-15'],
                      accessoriesCounts,
                      constructionCounts,
                      tradeCounts
                  ]
              },
              axis: {
                  x: {
                      type: 'timeseries',
                      tick: {
                          format: '%m-%Y'
                      }
                  }
              }
            });
          
        });

        var urlYearCompare = 'http://www.civicdata.com/api/action/datastore_search_sql?sql=SELECT%20substring(%22DATE%20OPENED%22%20from%201%20for%204)%20as%20Year,%20substring(%22DATE%20OPENED%22%20from%206%20for%202)%20as%20Month,%20count(*)%20as%20Count%20from%20%22163d8400-3ffd-4739-82c9-8c2f58ecd923%22%20group%20by%20Year,%20Month%20order%20by%20Year,%20Month';

        requestJSON(urlYearCompare, function(json) {
          var records = json.result.records
          var count98 = ['1998'];
          var count99 = ['1999'];
          var count00 = ['2000'];
          var count01 = ['2001'];
          var count02 = ['2002'];
          var count03 = ['2003'];
          var count04 = ['2004'];
          var count05 = ['2005'];
          var count06 = ['2006'];
          var count07 = ['2007'];
          var count08 = ['2008'];
          var count09 = ['2009'];
          var count10 = ['2010'];
          var count11 = ['2011'];
          var count12 = ['2012'];
          var count13 = ['2013'];
          var count14 = ['2014'];
          for(var i=0; i<records.length; i++) {
            if (records[i].year == "1998")
              count98.push(parseInt(records[i].count));
            if (records[i].year == "1999")
              count99.push(parseInt(records[i].count));
            if (records[i].year == "2000")
              count00.push(parseInt(records[i].count));
            if (records[i].year == "2001")
              count01.push(parseInt(records[i].count));
            if (records[i].year == "2002")
              count02.push(parseInt(records[i].count));
            if (records[i].year == "2003")
              count03.push(parseInt(records[i].count));
            if (records[i].year == "2004")
              count04.push(parseInt(records[i].count));
            if (records[i].year == "2005")
              count05.push(parseInt(records[i].count));
            if (records[i].year == "2006")
              count06.push(parseInt(records[i].count));
            if (records[i].year == "2007")
              count07.push(parseInt(records[i].count));
            if (records[i].year == "2008")
              count08.push(parseInt(records[i].count));
            if (records[i].year == "2009")
              count09.push(parseInt(records[i].count));
            if (records[i].year == "2010")
              count10.push(parseInt(records[i].count));
            if (records[i].year == "2011")
              count11.push(parseInt(records[i].count));
            if (records[i].year == "2012")
              count12.push(parseInt(records[i].count));
            if (records[i].year == "2013")
              count13.push(parseInt(records[i].count));
            if (records[i].year == "2014")
              count14.push(parseInt(records[i].count));
          }

            var chart = c3.generate({
              bindto: '#chartYear',
              data: {
                  columns: [
                      //['x', '01', '02','03', '04', '05', '06', '07', '08', '09', '10', '11', '12'],
                      count98,
                      count99,
                      count00,
                      count01,
                      count02,
                      count03,
                      count04,
                      count05,
                      count06,
                      count07,
                      count08,
                      count09,
                      count10,
                      count11,
                      count12,
                      count13,
                      count14
                  ]
              },
              axis: {
                  x: {
                      type: 'categorized',
                      categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
                  }
              }
            });
          
        });        

        var urlPie = 'http://www.civicdata.com/api/action/datastore_search_sql?sql=SELECT%20%22RECORD%20TYPE%20SUBTYPE%22%20as%20RecordType,%20count(*)%20as%20Count%20from%20%22163d8400-3ffd-4739-82c9-8c2f58ecd923%22%20group%20by%20RecordType%20order%20by%20Count%20desc';
            // Draw the bar chart.
        requestJSON(urlPie, function(json) {
          var records = json.result.records
          var pieCounts = [];
          for(var i=0; i<records.length; i++) {
            pieCounts.push([records[i].recordtype,parseInt(records[i].count)]);
          }
          var pieChart = c3.generate({
              bindto: '#pieChart',
              data: {
                  // iris data from R
                  columns: pieCounts,
                  type : 'pie',
              },
              pie: {
                  onclick: function (d, i) { console.log(d, i); },
                  onmouseover: function (d, i) { console.log(d, i); },
                  onmouseout: function (d, i) { console.log(d, i); }
              }
          });

          });



      });
    </script>
  </body>
</html>